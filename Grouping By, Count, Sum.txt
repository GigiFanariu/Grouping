CREATE TABLE MEAL(
  NAME VARCHAR (255),
  PRICE INT,
  CALORIES INT
  );
  INSERT INTO MEAL
  VALUES ('Spaghetti Bolognese', 15.00, 700);
    INSERT INTO MEAL
  VALUES ('Pesto Pasta', 10.00, 800);
    INSERT INTO MEAL
  VALUES ('Grilled Chicken Sandwich', 19.00, 1000);
  
CREATE TABLE MEAL_ORDER (
  TIME_MEAL_ORDERED TIMESTAMP DEFAULT NOW(),
  MEAL_NAME VARCHAR(255)
);
  
    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (NOW(), 'Spaghetti Bolognese');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 1 HOUR), 'Grilled Chicken Sandwich');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 2 HOUR), 'Pesto Pasta');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 3 HOUR), 'Pesto Pasta');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 4 HOUR), 'Grilled Chicken Sandwich');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 5 HOUR), 'Pesto Pasta');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 6 HOUR), 'Spaghetti Bolognese');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 7 HOUR), 'Pesto Pasta');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 8 HOUR), 'Pesto Pasta');

    INSERT INTO MEAL_ORDER (TIME_MEAL_ORDERED, MEAL_NAME) 
    VALUES (DATE_ADD(NOW(), INTERVAL 9 HOUR), 'Spaghetti Bolognese');

CREATE VIEW MEAL_ORDER_WITH_DETAILS AS 
    SELECT MO.*, M.PRICE, M.CALORIES FROM MEAL_ORDER MO, MEAL M 
    WHERE MO.MEAL_NAME = M.NAME;

RUN CODE:

SELECT MEAL_NAME, COUNT(*)
FROM MEAL_ORDER
GROUP BY MEAL_NAME;

SELECT  SUM(PRICE) FROM MEAL_ORDER_WITH_DETAILS
WHERE PRICE > 15.00;

SELECT  COUNT(*) FROM  MEAL_ORDER_WITH_DETAILS
WHERE CALORIES > 500;

SELECT SUM(PRICE) FROM MEAL
WHERE NAME LIKE 's';

SELECT TIME_MEAL_ORDERED, COUNT(*) AS order_count
FROM MEAL_ORDER
WHERE TIME_MEAL_ORDERED < '2023-10-06 18:00:00'
GROUP BY MEAL_ORDER_WITH_DETAILS;